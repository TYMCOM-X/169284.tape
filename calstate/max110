        SUBROUTINE WRETA(IND,TEMP,ETA,INDETA,ETAINC)
        DOUBLE PRECISION OBVAL
        DIMENSION TEMP(1),ETA(1),INDETA(1),ETAINC(1)
C DECLARATIONS MADE 6/19/73
C*S     START COMMON
        COMMON /MIPCOM/ V,AV,WDCNT,DUEL,IR,IK,RI,L,M,N
        COMMON /MIPCOM/ Q,QP,QPP,NETA,MAXETA,PRIM,NODUAL,NOPRIM
        COMMON /MIPCOM/ BIG,NPM,MP1,NP1,DELTA,UNB,ITYPE,ISTAR,IRP,IRPP
        COMMON /MIPCOM/ TOL,TOL1,OPTION,ISW,ID,CHSIN,ITER,OBVAL,OBJ1
        COMMON /OUTCOM/ JL,JR,NAML,VAL,NAMR,KR,PR
        COMMON /LINCNT/ LINE,IEUSE,INCETA
C       LINE IS CURRENT LINE NO. IN CREATE FILE
        INTEGER DICT, OPTION, OBJ1
        INTEGER V,AV,CB,CN,WDCNT,DUEL ,PRIM,UNB,RI
C*E     END COMMON
C
C       COMMON DECLARATIONS FOR MIP
C
C
C
C       WRETA WRITES A VECTOR TO ETAFIL.
C       THE FORMAT OF THIS VECTOR IS (IND,E1,E2,..,EM)
C       WHERE IND IS THE COLUMN INDEX OF THE VECTOR.  THE E'S ARE
C       COMPONENTS OF THE VECTOR, ANY OF THE E'S MAY REPRESENT
C       SQUEEZED ZERO ELEMENTS OF THE VECTOR.  THE NUMBER OF ZEROES
C       SQUEEZED IS AN INTEGER. (THIS DISTINGUISHES IT FROM AN ORDINARY
C       COMPONENT SINCE THE HIGH ORDER 10 BITS WOULD BE NON-ZERO FOR A
C
C


        IF(IEUSE.GE.INCETA) GO TO 5010

        JJ=IEUSE*(M+1)
        ETAINC(JJ+1)=FLOAT(IND)
C       TYPE 10000,INCETA,IEUSE,JJ
10000   FORMAT(3G)
        DO 5005 II=1,M
5005    ETAINC(JJ+II+1)=ETA(II)

        IEUSE=IEUSE+1
        NETA=NETA+1

        INDETA(NETA)=-5000-JJ-1
        GO TO 8999
C       SET COLUMN INDEX IN FIRST ENTRY
D
D       WRITE(ID,5000)
D5000   FORMAT('  ***ENTERING WRETA '/)
D       WRITE (ID,5100) (I,ETA(I),I=1,M)
D5100   FORMAT(1X,I4,1X,G)
5010    TEMP(1) = FIX(IND)
      
        I = 2


C      WRITE OUT VECTOR TO ETAFIL AND RETURN
C
C       NEXT WRITE  ADDRES IS ALREADY IN V


        IF(NETA .GE. MAXETA)  GO TO 9000

C       WRITE(4#V) IND,(ETA(I), I =1, M)
C
C       COMPRESS VECTORS BY SQUEEZING ZEROES
C
C       I IS INDEX TO TEMP
C       J IS INDEX TO ETA
C
        I = 1
        DO 4000 J = 1, M
C       CHECK FOR 2 OR MORE CONTIGUOUS ZEROES
C
        IF(ETA(J) .NE. 0) GO TO 3850
        IF(ETA(J+1).NE. 0) GO TO 3850
C       HERE TO COUNT SQUEEZED ZEROES
        KNT = 2
        TEMP(I) = FIX(2)
        J = J + 2
3700    IF(ETA(J) .NE. 0) GO TO 3900
C       INCREASE ZERO COUNT
C       PLAY GAMES SINCE DUMMY VARIABLE CANNOT BE
C       EQUIVALENCED
C
        KNT = KNT + 1
        TEMP(I) = FIX(KNT)
C
        J = J + 1
        IF(J .LE. M) GO TO 3700
C       FALL THROUGH INDICATES DONE WITH ETA
        GO TO 4100
3900    J = J -1
C       RESET INDEX AND CONTINUE LOOP
        GO TO 3800
3850    TEMP(I) = ETA(J)
3800    I = I + 1
4000    CONTINUE

        I = I - 1

4100    CONTINUE




        WRITE(4#V) IND,(TEMP(J), J = 1, I)
C       INCREMENT COUNT OF ETA VECTORS
        NETA = NETA + 1
C       SET WORD COUNT AND RECORD ADDRES AND RETURN
        INDETA(NETA) = V   + (I * 2**18)
C       SAVE NEXT WRITE ADDRESS
        V = POSITION(4)
8999    RETURN
9000    WRITE(5,9001)
9001    FORMAT(' MAXIMUM NUMBER OF ETA VECTORS EXCEEDED.')
        CALL EXIT

        END
